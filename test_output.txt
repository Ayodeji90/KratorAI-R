============================= test session starts ==============================
platform linux -- Python 3.12.3, pytest-9.0.2, pluggy-1.6.0
rootdir: /home/machinemustlearn/Desktop/KratorAI/gemini-integration
plugins: asyncio-1.3.0, anyio-4.2.0
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collected 2 items

tests/test_describe.py Response: {"detail":"cannot identify image file <_io.BytesIO object at 0x7512ac1f7470>"}
F.

=================================== FAILURES ===================================
____________________________ test_describe_endpoint ____________________________

mock_gemini_response = <MagicMock name='GenerativeModel()' id='128723067806560'>

    def test_describe_endpoint(mock_gemini_response):
        # Create a dummy image file
        file_content = b"fake image content"
        file = io.BytesIO(file_content)
    
        response = client.post(
            "/describe",
            files={"file": ("test.png", file, "image/png")}
        )
    
        if response.status_code != 200:
            print(f"Response: {response.text}")
>       assert response.status_code == 200
E       assert 500 == 200
E        +  where 500 = <Response [500 Internal Server Error]>.status_code

tests/test_describe.py:31: AssertionError
=============================== warnings summary ===============================
src/config.py:7
  /home/machinemustlearn/Desktop/KratorAI/gemini-integration/src/config.py:7: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class Settings(BaseSettings):

src/services/gemini_client.py:3
  /home/machinemustlearn/Desktop/KratorAI/gemini-integration/src/services/gemini_client.py:3: FutureWarning: 
  
  All support for the `google.generativeai` package has ended. It will no longer be receiving 
  updates or bug fixes. Please switch to the `google.genai` package as soon as possible.
  See README for more details:
  
  https://github.com/google-gemini/deprecated-generative-ai-python/blob/main/README.md
  
    import google.generativeai as genai

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/test_describe.py::test_describe_endpoint - assert 500 == 200
=================== 1 failed, 1 passed, 2 warnings in 9.33s ====================
